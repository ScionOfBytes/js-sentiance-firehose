var SentianceFirehose=function(){var e,n,t=1e3,i=function(e,n,t,i){setTimeout(a(e,n,t,i))},r=function(){n&&n.connected&&n.disconnect()},o=function(n){e=n},a=function(n,t,i,r){if(!n)throw new Error("No app id configured");if(!t)throw new Error("No stream definition id configured");if(!i)throw new Error("No bearer token configured");if(!e)throw new Error("No data handler configured");c(n,t,i,r)},s=function(e,n,i,r){t=2*t,setTimeout(function(){a(e,n,i,r)},t)},c=function(e,n,t,i){var r=new XMLHttpRequest,o={query:"        mutation($app_id: String!, $stream_definition_id: String!, $user_ids: [String]) {          createSubscription(app_id:$app_id, stream_definition_id: $stream_definition_id, user_ids: $user_ids) {            id            token          }        }      ",variables:{app_id:e,stream_definition_id:n,user_ids:i||null}};r.open("POST","https://api.sentiance.com/v2/gql",!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Bearer "+t),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var o=JSON.parse(r.responseText);if(o.data&&o.data.createSubscription){var a=o.data.createSubscription.id,c=o.data.createSubscription.token;d(a,c)}else s(e,n,t,i)}else s(e,n,t,i)},r.send(JSON.stringify(o))},d=function(t,i){n=io("https://firehose.sentiance.com/"),n.on("connect",function(){u(n,t,i)}),n.on("data",function(n){var t=JSON.parse(n);e(t.data,t.errors,t.metadata)}),n.on("disconnect",function(){}),n.on("error",function(e){})},u=function(e,n,t){var i={id:n,token:t};e.emit("subscribe-v1",i)};return{connect:i,disconnect:r,onData:o}}();